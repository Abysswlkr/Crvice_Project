<!DOCTYPE html>
<html>
<head>
    <title>Perfil de Usuario</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />

</head>
<app-navbar></app-navbar>
<body>
    
    <!-- seccion datos personales -->
    <section class="datos-personales">
      <div class="container" *ngIf="user$ | async as user">
        <div class="izq">
          <div class="div-imagen">
            <img [src]="user.photoURL ?? '/assets/img/image-placeholder.png'" />
          </div>
          <div id="wrap" (click)="inputField.click()">
            <a class="btn-slide">
              <span class="circle"><mat-icon>edit</mat-icon></span>
              <span class="title">Editar</span>
              <span class="title-hover">...</span>
            </a>
          </div>
        </div>
        <input #inputField hidden type="file" (change)="uploadFile($event, user)" />
    
        <div class="der">
          <h2>Datos Personales</h2>
          <div class="datos" *ngIf="info">
                    <label>Nombre:</label>
                    <p class="p-datos"> {{info.nombre}} </p>
                    <hr>
                    <label>Apellido:</label>
                    <p class="p-datos"> {{info.apellido}} </p>
                    <hr>
                    <label>RUT:</label>
                    <p> {{info.rut}}-{{info.dv}} 
                    </p>
                    <hr>
                    <label>Correo Electronico:</label>
                    <p> {{info.correo}} </p>
                    <hr>
                    <label>Teléfono:</label>
                    <p class="p-datos"> {{info.telefono}} 
                    </p>
                    <!-- prompt -->
                    <div class="profile">
                      <!-- Otros elementos HTML existentes... -->
                      <button (click)="mostrarPrompt('telefono')">Editar</button>
                      <div class="dialog-overlay" *ngIf="mostrarDialogo">
                        <div class="dialog-container">
                          <app-custom-prompt (saveClicked)="onCustomPromptSave($event)" (promptClosed)="closePrompt()"></app-custom-prompt>
                        </div>
                      </div>                          
                    </div>
                    <!-- prompt -->
                    <hr>
                    <label>Dirección:</label>
                    <p class="p-datos"> {{info.direccion}} {{info.numDireccion}} 
                    </p>
                    <hr>
                    <label>Comuna:</label>
                    <p class="p-datos"> {{info.comuna}} 
                    </p>
                    <hr>
                    <label>Fecha de Nacimiento:</label>
                    <p> {{info.nacimiento}} 
                    </p>
                    <hr>
                    <hr>
                    <p> Si necesitas asistencia en cambio de tus datos, habla con nosotros </p> 
                    <div div *ngFor="let user of users$ | async">
                      <p *ngIf="user.uid == adminId" (click)="createChat(user)">aqui</p>
                    </div> 
                    <hr>
                    <div class="div-botones">
                        <!-- <button class="cerrar-sesion" (click)="resetPassword()">Cambiar contraseña</button> -->
                        <!-- <button class="cerrar-sesion" (click)="logout()">Cerrar Sesion</button>  -->
                        <button class="cerrar-sesion" *ngIf="info.perfil.toString() === '2'" (click)="verMisContrataciones()">Mis Contrataciones</button>
                        <button class="cerrar-sesion" *ngIf="info.perfil.toString() === '1'" (click)="crearPublicacion()">Crear publicación</button>
                        <button class="cerrar-sesion" *ngIf="info.perfil.toString() === '1'" (click)="verMisPublicaciones()">Mis publicaciones</button>
                        <button class="cerrar-sesion" *ngIf="info.perfil.toString() === '1'" (click)="verMisSolicitudes()">Mis Solicitudes</button>
                        <button class="cerrar-sesion" *ngIf="info.perfil.toString() === '3'" (click)="gestPublicaciones()">Gestionar Publicaciones</button>

                    </div>
                    
                </div>
            </div>
        </div>
    </section>
    <!-- seccion comentarios -->
    <div class="container contenedor-comentario">
      <h2>Calificación y Comentarios</h2>
      <p>Calificación General: {{ averageRating }}</p>
      <div class="comentario" *ngFor="let calificacion of ratings.slice(0, contador)">
        <div>
          <img class="img-comentario" src="../../../assets/img/foto1.jpg" alt="">
        </div>
        <div class="div-comentario">
          <p>
            <span class="etiqueta">Calificación:</span>
            <span class="estrellas">
              <i class="fas fa-star llena" *ngFor="let i of [1, 2, 3, 4, 5]" [ngClass]="{'vacia': i > calificacion.calificacion}"></i>
            </span>
          </p>
          <p>Comentario: {{ calificacion.comentario }}</p>
        </div>
      </div>
    
      <button class="mas-comentarios" (click)="cargarMasComentarios()">Cargar más comentarios</button>
      <button class="mas-comentarios" *ngIf="mostrarCargarMenos" (click)="cargarMenosComentarios()">Mostrar menos comentarios</button>
    </div>
    
    
    
    
    



</body>

<app-footer></app-footer>
</html>


